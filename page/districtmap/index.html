<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Washington DC Area Immersion Schools</title>
    <script src="https://d3js.org/d3.v3.min.js"></script>
    <script src="https://d3js.org/topojson.v1.min.js"></script>
    <script src="http://d3js.org/queue.v1.min.js"></script>
    <!--<script src="http://cdnjs.cloudflare.com/ajax/libs/crossfilter/1.3.7/crossfilter.js"></script>-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-legend/1.5.0/d3-legend.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.10.1/lodash.js"></script>

    <style type="text/css">
        body {
            background-color: white;
            font-family: Helvetica, Arial, sans-serif;
        }

        h1 {
            font-size: 26px;
            margin: 7px;
        }

        h3 {
            font-size: 13px;
            margin: 7px;
            font-weight: normal;
        }

        svg {
            background-color: white;
        }
        

        #districttooltip {
            font-family: Helvetica, Arial, sans-serif;
            z-index: 1;
            position: absolute;
            width: auto;
            height: auto;
            padding: 2px;
            background-color: white;
            opacity: 1;
            font-size: 10px;
            -webkit-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
            -moz-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
            box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
            pointer-events: none;
        }

            #districttooltip.hidden {
                display: none;
            }

        .districtLabel {
            font-weight: bolder;
            font-size: 24px;
            width: 60px;
            text-anchor: middle;
            cursor: default;
            /*background: #ffffff;*/
            pointer-events: none;
            stroke: lightgrey;
            fill: grey;
        }

        .schoolLabel {
            /*font-weight: bold;*/
            font-size: 12px;
            width: 60px;
            text-anchor: middle;
            cursor: default;
            background: #ffffff;
            pointer-events: none;
        }

    </style>
</head>
<body>
    <h1>Washington DC Area Immersion Schools</h1>
    <h3></h3>

    <script type="text/javascript">

        var width = 900;
        var height = 800;

        var svg = d3.select("body")
                    .append("svg")
                    .attr("width", width)
                    .attr("height", height);

        queue()
            .defer(d3.json, '../../map/dc_counties.json')
            .await(setupMap);


        function setupMap(error, counties) {
            var projection = makeProjection(counties);
            var path = d3.geo.path()
                .projection(projection);

            svg.selectAll("path")
                .data(counties.features)
                .enter()
                .append("path")
                .attr("d", path)
                .attr("stroke", "dimgray")
                .style("fill", function (d) {
                    return "lightgrey";
                })
                .style("fill-opacity", function (d) {
                    return d.value ? 0.5 : 1.0;
                });
        }

        // http://stackoverflow.com/questions/14492284/center-a-map-in-d3-given-a-geojson-object
        function makeProjection(features) {
            var projection = d3.geo.albers()
                .scale(1)
                .translate([0, 0]);

            // Create a path generator.
            var path = d3.geo.path()
                .projection(projection);

            // Compute the bounds of a feature of interest, then derive scale & translate.
            var scootLeft = 40;
            var b = path.bounds(features),
                s = .95 / Math.max((b[1][0] - b[0][0]) / width, (b[1][1] - b[0][1]) / height),
                t = [((width - s * (b[1][0] + b[0][0])) / 2) - scootLeft, (height - s * (b[1][1] + b[0][1])) / 2];

            // Update the projection to use computed scale & translate.
            projection
                .scale(s)
                .translate(t);

            return projection;
        }
    </script>
</body>
</html>